# フルーツバスケット パズル

## 概要
ブラウザで遊べるシンプルな合成パズルゲームです。6x6のボードに果物やごはんのピースを配置し、同じ種類を3つ以上隣接させて進化させ、ハイスコアを目指します。スマートフォンとPCの両方で快適にプレイできます。

## 機能
- **6x6のゲームボード**: ピースを配置するメインエリアです。
- **ピースの種類**:
  - **果物ピース**: 🍒→🍊→🍇→🍎→🍑→🍍→🍈→🍉 の8段階で進化します。
  - **ごはんピース**: 🍚→🍙→🍱 の3段階で進化します。
  - **おじゃまピース (👨)**:
    - プレイヤーがピースを置いた次のターンから、ボード上の空きマスを1マス移動します。
    - ピースや壁で完全に囲んで移動できなくすると、捕獲成功となり「**ごはん(🍚)**」に変化します。
    - このピースは直接合成できませんが、捕獲してごはんピースに変えることで、高得点を狙うことができます。
  - *注意: 果物とごはんは互いに合成できません。*
- **ピースの出現（袋システム）**:
  - ピースの出現は、完全にランダムではなく「袋」から1つずつ取り出す方式を採用しています。これにより、短期間でのピースの偏りがなくなり、より公平で戦略的なゲームプレイが楽しめます。
  - **通常袋 (15個入り)**: 🍒x5, 🍊x3, 🍇x2, 🍎x1, 👨x2, ☀️x1, 🐻x1
  - **レア袋 (6個入り)**: 🍊x1, 🍇x2, 🍎x1, ☀️x1, 🐻x1
- **自動合成と連鎖**:
  - 同じピースが3つ以上隣接すると、自動的に1つ上のレベルのピースに進化します。
  - **連鎖ボーナス**: 進化によって新たな合成が誘発されると「連鎖」となり、連鎖数に応じてスコアにボーナスが加算されます。**2連鎖以上を達成すると、次の1手は「レア袋」からピースが出現します！**
  - **同時消しボーナス**: 1手で2ヶ所以上の合成が同時に発生すると、その手のスコアにさらにボーナスが加算されます。
- **ホールド機能**: ボード左上の「🍽️（皿）」マスを使うと、次のピースを一時的に保管したり、保管中のピースと交換したりできます。
- **アイテムシステム**: ゲームを有利に進めるためのアイテムが5種類用意されています。
  - ☀️ **太陽 (ジョーカー)**: 空いているマスに配置すると、隣接するピースをコピーして合成を試みます。その際、最も**連鎖数が多く、次いでスコアが高くなる**ような最適な合成を自動的に選択します。合成に失敗した場合は「**チェリー(🍒)**」に変化します。
  - 🐻 **熊**: ターゲットによって効果が変わります。
    - **おじゃまピース(👨)に使うと**: 「**ごはん(🍚)**」に変化させます。
    - **その他のピース(果物、ごはん)に使うと**: そのマスからピースを**消去**します。
  - 🍒/🍊/🍇: 指定した果物ピースをボード上の空いているマスに配置できます。
  - *初期所持数: 太陽と熊は各5個、各種フルーツアイテムは各10個からスタートします。*
- **スコアとハイスコア**: ピースを合成するとスコアを獲得。ハイスコアはブラウザの`localStorage`に保存されます。
- **ヒントエリア**: ゲーム画面下部で、**果物ピースとおじゃまピースの進化経路**をいつでも確認できます。
- **レスポンシブデザイン**: PC、タブレット、スマートフォンの画面サイズに最適化されています。

## 操作方法
1.  **ピースの配置**: ボード上の**空いているマスならどこでも**タップまたはクリックしてピースを配置できます。光っているマスは、AIが計算したおすすめの配置場所のヒントです。
2.  **ホールド**: 左上の「🍽️」マスをタップすると、次のピースを保留/交換できます。
3.  **アイテムの使用**:
    - 「アイテム」ボタンから使いたいアイテムを選択します。
    - 次に配置するピースが選択したアイテムに変わるので、ボード上の好きなマスをタップして使用します。
4.  **ルールの確認**: 「あそびかた」ボタンで、いつでも基本的な遊び方を確認できます。
5.  **リスタート**: ゲームを最初からやり直したい場合は「リスタート」ボタンを押します。

## ファイル構成
- `index.html`: ゲームのHTML構造。ゲーム画面、各種モーダル（ルール、ショップ、ゲームオーバー）を定義。
- `styles.css`: ゲームの見た目を定義。背景デザイン、ボードデザイン、アニメーション、レスポンシブ対応など。
- `script.js`: ゲームの全ロジック。ボード管理、ピースの生成、合成処理、スコア計算、イベントハンドリングなど。
- `README.md`: このファイル。ゲームの概要や仕様を記載。

## セットアップ
1.  提供された4つのファイル (`index.html`, `styles.css`, `script.js`, `README.md`) を同じフォルダに保存します。
2.  ローカルサーバーを起動して `index.html` にアクセスします。（例: `npx http-server .`）
3.  最新版のGoogle ChromeまたはSafariでプレイしてください。

## ライセンス
MITライセンス